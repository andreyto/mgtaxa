<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>Mgtaxa: MGT::TaxaIODb::NodeStorageDb Class Reference</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
<link href="tabs.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.4.6 -->
<div class="tabs">
  <ul>
    <li><a href="index.html"><span>Main&nbsp;Page</span></a></li>
    <li id="current"><a href="annotated.html"><span>Classes</span></a></li>
    <li><a href="pages.html"><span>Related&nbsp;Pages</span></a></li>
  </ul></div>
<div class="tabs">
  <ul>
    <li><a href="annotated.html"><span>Class&nbsp;List</span></a></li>
    <li><a href="hierarchy.html"><span>Class&nbsp;Hierarchy</span></a></li>
    <li><a href="functions.html"><span>Class&nbsp;Members</span></a></li>
  </ul></div>
<div class="nav">
<b>MGT</b>::<b>TaxaIODb</b>::<a class="el" href="classMGT_1_1TaxaIODb_1_1NodeStorageDb.html">NodeStorageDb</a></div>
<h1>MGT::TaxaIODb::NodeStorageDb Class Reference</h1><!-- doxytag: class="MGT::TaxaIODb::NodeStorageDb" --><a href="classMGT_1_1TaxaIODb_1_1NodeStorageDb-members.html">List of all members.</a><table border="0" cellpadding="0" cellspacing="0">
<tr><td></td></tr>
<tr><td colspan="2"><br><h2>Public Member Functions</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">def&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMGT_1_1TaxaIODb_1_1NodeStorageDb.html#214b285535750e049d95cbc10ee7858d">loadAttribute</a></td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">def&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMGT_1_1TaxaIODb_1_1NodeStorageDb.html#1fe17a7d9f1d5dd9144fa0d37d0bee4a">saveAttributes</a></td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">def&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMGT_1_1TaxaIODb_1_1NodeStorageDb.html#bc0826a992636fe4b0edc0c14aeccbf0">loadSeqLen</a></td></tr>

<tr><td colspan="2"><br><h2>Static Public Attributes</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">string&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMGT_1_1TaxaIODb_1_1NodeStorageDb.html#c6c44460df4ce794c90f1c20ed4e9a3c">tblNames</a> = &quot;taxa_names&quot;</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Currently, we consider taxa names immutable and originating from the initial NCBI taxonomy dump file, so load them from a fixed DB table named by 'tblNames'.  <a href="#c6c44460df4ce794c90f1c20ed4e9a3c"></a><br></td></tr>
</table>
<hr><a name="_details"></a><h2>Detailed Description</h2>
<div class="fragment"><pre class="fragment">Taxonomy nodes storage in SQL DB</pre></div> 
<p>
<hr><h2>Member Function Documentation</h2>
<a class="anchor" name="214b285535750e049d95cbc10ee7858d"></a><!-- doxytag: member="MGT::TaxaIODb::NodeStorageDb::loadAttribute" ref="214b285535750e049d95cbc10ee7858d" args="" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">def MGT::TaxaIODb::NodeStorageDb::loadAttribute           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">&nbsp;</td>
          <td class="mdname" nowrap> <em>self</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>&nbsp;</td>
          <td class="mdname" nowrap> <em>tree</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>&nbsp;</td>
          <td class="mdname" nowrap> <em>name</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>&nbsp;</td>
          <td class="mdname" nowrap> <em>sql</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>&nbsp;</td>
          <td class="mdname" nowrap> <em>default</em> = <code>None</code>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>&nbsp;</td>
          <td class="mdname" nowrap> <em>setDefault</em> = <code>True</code>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>&nbsp;</td>
          <td class="mdname" nowrap> <em>ignoreKeyError</em> = <code>True</code>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>&nbsp;</td>
          <td class="mdname" nowrap> <em>typeCast</em> = <code>None</code></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
<div class="fragment"><pre class="fragment">Execute 'sql' which should return a unique mapping taxid -&gt; value and assign result to each node.
@param name - name of the new treee nodee attribbute to set
@param sql - statement to execute. It must return (id,value) pairs (in that order) with 'id' corresponding to tree node id's.
Actual column names do not matter.
@param default - assign this value to those nodes for which taxid is not present in the 'sql' result set (if 'setDeafult' is True)
@param setDefault - if False, do not assign default value to nodes
@param ignoreKeyError - if True, do not raise exception if 'sql' results set contains an id that is not present in the tree.
</pre></div>     </td>
  </tr>
</table>
<a class="anchor" name="bc0826a992636fe4b0edc0c14aeccbf0"></a><!-- doxytag: member="MGT::TaxaIODb::NodeStorageDb::loadSeqLen" ref="bc0826a992636fe4b0edc0c14aeccbf0" args="" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">def MGT::TaxaIODb::NodeStorageDb::loadSeqLen           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">&nbsp;</td>
          <td class="mdname" nowrap> <em>self</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>&nbsp;</td>
          <td class="mdname" nowrap> <em>tree</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>&nbsp;</td>
          <td class="mdname" nowrap> <em>name</em> = <code>&quot;seq_len&quot;</code>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>&nbsp;</td>
          <td class="mdname" nowrap> <em>sql</em> = <code>&quot;select&nbsp;taxid</code>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>&nbsp;</td>
          <td class="mdname" nowrap> <em>seq_len</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>&nbsp;</td>
          <td class="mdname" nowrap> <em>from</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>&nbsp;</td>
          <td class="mdname" nowrap> <em>taxa_seq_len</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
<div class="fragment"><pre class="fragment">Load sequence length from DB and also assign accumulated subtree sequence to attribute name+'_tot'
Parameters have the same meaning as for for loadAttribute().
Default value of 0L is used.</pre></div>     </td>
  </tr>
</table>
<a class="anchor" name="1fe17a7d9f1d5dd9144fa0d37d0bee4a"></a><!-- doxytag: member="MGT::TaxaIODb::NodeStorageDb::saveAttributes" ref="1fe17a7d9f1d5dd9144fa0d37d0bee4a" args="" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">def MGT::TaxaIODb::NodeStorageDb::saveAttributes           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">&nbsp;</td>
          <td class="mdname" nowrap> <em>self</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>&nbsp;</td>
          <td class="mdname" nowrap> <em>tree</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>&nbsp;</td>
          <td class="mdname" nowrap> <em>nameToSql</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>&nbsp;</td>
          <td class="mdname" nowrap> <em>table</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
<div class="fragment"><pre class="fragment">Save attribute values of tree nodes as a new table indexed by node id.
@param tree - tree to work on
@nameToSql - mapping of attribute names into SQL, by example: {'rankUpper':{'name':'rank_upper','type':'char(20)','createIndex':True,default=0}}. If 'name' is not present, the key of the dictionary will be used as is for SQL column
name. That might lead to problems if SQL server converts all names to lower case, for instance. It is not a good
idea to rely on identifier case in SQL code anyway.
@param table - SQL table name to create
</pre></div>     </td>
  </tr>
</table>
<hr><h2>Member Data Documentation</h2>
<a class="anchor" name="c6c44460df4ce794c90f1c20ed4e9a3c"></a><!-- doxytag: member="MGT::TaxaIODb::NodeStorageDb::tblNames" ref="c6c44460df4ce794c90f1c20ed4e9a3c" args="" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">string <a class="el" href="classMGT_1_1TaxaIODb_1_1NodeStorageDb.html#c6c44460df4ce794c90f1c20ed4e9a3c">MGT::TaxaIODb::NodeStorageDb::tblNames</a> = &quot;taxa_names&quot;<code> [static]</code>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Currently, we consider taxa names immutable and originating from the initial NCBI taxonomy dump file, so load them from a fixed DB table named by 'tblNames'. 
<p>
This assumes that all other trees that we construct are reductions of that original NCBI tree. This might change in the future, in which case we will use specific name table for each tree. It will still make sense to keep the names in a separate table because they are long and rarely needed strings. Currently we just expect the 'tblNames' to be loaded into the database already.     </td>
  </tr>
</table>
<hr>The documentation for this class was generated from the following file:<ul>
<li>mgtaxa/MGT/TaxaIODb.py</ul>
<hr size="1"><address style="align: right;"><small>Generated on Wed Jul 29 17:53:24 2009 for Mgtaxa by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.4.6 </small></address>
</body>
</html>
