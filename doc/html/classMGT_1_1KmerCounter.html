<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>Mgtaxa: MGT::KmerCounter Class Reference</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
<link href="tabs.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.4.6 -->
<div class="tabs">
  <ul>
    <li><a href="index.html"><span>Main&nbsp;Page</span></a></li>
    <li id="current"><a href="annotated.html"><span>Classes</span></a></li>
    <li><a href="pages.html"><span>Related&nbsp;Pages</span></a></li>
  </ul></div>
<div class="tabs">
  <ul>
    <li><a href="annotated.html"><span>Class&nbsp;List</span></a></li>
    <li><a href="hierarchy.html"><span>Class&nbsp;Hierarchy</span></a></li>
    <li><a href="functions.html"><span>Class&nbsp;Members</span></a></li>
  </ul></div>
<div class="nav">
<b>MGT</b>::<a class="el" href="classMGT_1_1KmerCounter.html">KmerCounter</a></div>
<h1>MGT::KmerCounter Class Reference</h1><!-- doxytag: class="MGT::KmerCounter" -->Class that computes k-mer counts of incoming nucleotide sequence.  
<a href="#_details">More...</a>
<p>
<code>#include &lt;kmers.hpp&gt;</code>
<p>
<p>Inheritance diagram for MGT::KmerCounter:
<p><center><img src="classMGT_1_1KmerCounter.png" usemap="#MGT::KmerCounter_map" border="0" alt=""></center>
<map name="MGT::KmerCounter_map">
<area href="classMGT_1_1Kmers_1_1KmerSparseFeatures.html" alt="MGT::Kmers::KmerSparseFeatures" shape="rect" coords="0,56,205,80">
</map>
<a href="classMGT_1_1KmerCounter-members.html">List of all members.</a><table border="0" cellpadding="0" cellspacing="0">
<tr><td></td></tr>
<tr><td colspan="2"><br><h2>Public Member Functions</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMGT_1_1KmerCounter.html#e742819d55211c4b487b725ff759953a">KmerCounter</a> (int kmerLen, const <a class="el" href="classMGT_1_1AbcConvCharToInt.html">AbcConvCharToInt</a> *pAbcConv=0, RC_POLICY revCompPolicy=RC_MERGE, KmerId firstIdState=1)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">A constructor.  <a href="#e742819d55211c4b487b725ff759953a"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMGT_1_1KmerCounter.html#8c3029ba03a356a2d0743c2988e130c2">doCNuc</a> (CNuc cnuc)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">This method is called to process the input sequence.  <a href="#8c3029ba03a356a2d0743c2988e130c2"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="bee2df622432c361b9dde075212cff3d"></a><!-- doxytag: member="MGT::KmerCounter::doINuc" ref="bee2df622432c361b9dde075212cff3d" args="(INuc inuc)" -->
void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMGT_1_1KmerCounter.html#bee2df622432c361b9dde075212cff3d">doINuc</a> (INuc inuc)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">This method is called for each element of an input sequence (through <a class="el" href="classMGT_1_1KmerCounter.html#8c3029ba03a356a2d0743c2988e130c2">KmerCounter::doCNuc()</a> wrapper method). <br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMGT_1_1KmerCounter.html#e8f68bd7f63538018130c330a7c0c47a">maxNumKmers</a> (ULong seqLen) const </td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Return the maximum number of unique k-mers that can be found in a sequence of a given length.  <a href="#e8f68bd7f63538018130c330a7c0c47a"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="db179d480d813964e18b3d3dbd3c742a"></a><!-- doxytag: member="MGT::KmerCounter::getFirstIdState" ref="db179d480d813964e18b3d3dbd3c742a" args="() const " -->
KmerId&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMGT_1_1KmerCounter.html#db179d480d813964e18b3d3dbd3c742a">getFirstIdState</a> () const </td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Return first state ID (for non-degenerate k-mers). <br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="ff8636f04fc20765320884f493407a84"></a><!-- doxytag: member="MGT::KmerCounter::getLastIdState" ref="ff8636f04fc20765320884f493407a84" args="() const " -->
KmerId&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMGT_1_1KmerCounter.html#ff8636f04fc20765320884f493407a84">getLastIdState</a> () const </td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Return last used plus one state ID (for non-degenerate k-mers). <br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="1eb296d2048d38b7bf308f5d6a0dcecd"></a><!-- doxytag: member="MGT::KmerCounter::getNumIds" ref="1eb296d2048d38b7bf308f5d6a0dcecd" args="() const " -->
int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMGT_1_1KmerCounter.html#1eb296d2048d38b7bf308f5d6a0dcecd">getNumIds</a> () const </td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Get the total number of different IDs ("number of features") - depends on the RC_POLICY. <br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="classMGT_1_1KmerStates.html">KmerStates</a> &amp;&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMGT_1_1KmerCounter.html#346502c83e1eaaf1f2f56e9a75497374">getStates</a> ()</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Get reference to internal <a class="el" href="classMGT_1_1KmerStates.html">KmerStates</a> array.  <a href="#346502c83e1eaaf1f2f56e9a75497374"></a><br></td></tr>
<tr><td colspan="2"><div class="groupHeader">Interface to extract the results.</div></td></tr>
<tr><td colspan="2"><div class="groupText">The following set of methods defines the result extraction protocol. They must be called in a strict order because they change the internal state of KmerCounter object. The interface is designed for efficiency and flexibility of the caller. After doCNuc() has been called any number of times (we call this "accumulation cycle"), the extraction is done as in the following code sample, after which doCNuc() can be called again to accumulate new counts. <div class="fragment"><pre class="fragment"> <span class="keywordtype">int</span> n = o.numKmers();
 o.startKmer();
 <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i = 0; i &lt; n; i++,o.nextKmer()) {
     cout &lt;&lt; o.getKmerId() &lt;&lt; <span class="stringliteral">":"</span> &lt;&lt; o.getKmerCount() &lt;&lt; <span class="stringliteral">"\n"</span>;
 }
 o.finishKmer();
</pre></div> nextKmer() can be called less than numKmers() times. sumKmerCounts() can be called outside of startKmer()...finishKmer() block <br><br></div></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="23c040924a5342ae5983c559a63abdb4"></a><!-- doxytag: member="MGT::KmerCounter::numKmers" ref="23c040924a5342ae5983c559a63abdb4" args="() const " -->
int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMGT_1_1KmerCounter.html#23c040924a5342ae5983c559a63abdb4">numKmers</a> () const </td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Return number of k-mers found so far in current accumulation cycle. <br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">ULong&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMGT_1_1KmerCounter.html#8a2305e881fab8f4ae1f027db12cc728">sumKmerCounts</a> () const </td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Return sum of non-degenerate k-mer counts found so far in current accumulation cycle.  <a href="#8a2305e881fab8f4ae1f027db12cc728"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">ULong&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMGT_1_1KmerCounter.html#16cd8709c9c06ecd161908077474caad">sumDegenKmerCounts</a> () const </td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Return sum of degenerate k-mer counts found so far in current accumulation cycle.  <a href="#16cd8709c9c06ecd161908077474caad"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMGT_1_1KmerCounter.html#505f456b240c83241a312a43f7baf935">startKmer</a> (bool doSort=true)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Prepare internal state for result extraction.  <a href="#505f456b240c83241a312a43f7baf935"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="966aa0c624636c757d768faf05e823ca"></a><!-- doxytag: member="MGT::KmerCounter::nextKmer" ref="966aa0c624636c757d768faf05e823ca" args="()" -->
void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMGT_1_1KmerCounter.html#966aa0c624636c757d768faf05e823ca">nextKmer</a> ()</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Advance internal state to extract next k-mer results. <br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="764fcfb49316ce41ace642ecd156a097"></a><!-- doxytag: member="MGT::KmerCounter::getKmerCount" ref="764fcfb49316ce41ace642ecd156a097" args="() const " -->
ULong&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMGT_1_1KmerCounter.html#764fcfb49316ce41ace642ecd156a097">getKmerCount</a> () const </td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Accessor to get count value from the currently extracted k-mer. <br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="cea9ccbd1ec449d9c79fa4e85c97b1da"></a><!-- doxytag: member="MGT::KmerCounter::getKmerId" ref="cea9ccbd1ec449d9c79fa4e85c97b1da" args="() const " -->
int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMGT_1_1KmerCounter.html#cea9ccbd1ec449d9c79fa4e85c97b1da">getKmerId</a> () const </td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Accessor to get Id from the currently extracted k-mer. <br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="55c982de9482cad51bdda932d2b2c003"></a><!-- doxytag: member="MGT::KmerCounter::getKmerStr" ref="55c982de9482cad51bdda932d2b2c003" args="() const " -->
std::string&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMGT_1_1KmerCounter.html#55c982de9482cad51bdda932d2b2c003">getKmerStr</a> () const </td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Accessor to get k-mer string (such as 'ACCCT') for the currently extracted k-mer. <br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">Ind&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMGT_1_1KmerCounter.html#16c87e77c11ec12a1737ec488e3dcffc">indState</a> () const </td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Accessor to get index of the state for the currently extracted k-mer.  <a href="#16c87e77c11ec12a1737ec488e3dcffc"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">const <a class="el" href="classMGT_1_1KmerState.html">PKmerState</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMGT_1_1KmerCounter.html#51e80461c683377d4a8e05871f99b5c5">getState</a> () const </td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Accessor to get pointer to the state for the currently extracted k-mer.  <a href="#51e80461c683377d4a8e05871f99b5c5"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="3074692ee8bdbc3df80a235e4e9f8228"></a><!-- doxytag: member="MGT::KmerCounter::finishKmer" ref="3074692ee8bdbc3df80a235e4e9f8228" args="()" -->
void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMGT_1_1KmerCounter.html#3074692ee8bdbc3df80a235e4e9f8228">finishKmer</a> ()</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Finalize result extraction cycle - new series of <a class="el" href="classMGT_1_1KmerCounter.html#8c3029ba03a356a2d0743c2988e130c2">doCNuc()</a> calls can be done afterwards. <br></td></tr>
<tr><td colspan="2"><br><h2>Protected Attributes</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="30ef4db49a66603a9cd70cac7b346be3"></a><!-- doxytag: member="MGT::KmerCounter::m_revCompPolicy" ref="30ef4db49a66603a9cd70cac7b346be3" args="" -->
RC_POLICY&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMGT_1_1KmerCounter.html#30ef4db49a66603a9cd70cac7b346be3">m_revCompPolicy</a></td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">How reverse complements are treated - one of RC_XXX. <br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">std::vector&lt; <a class="el" href="classMGT_1_1KmerStateData.html">KmerStateData</a> &gt;&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMGT_1_1KmerCounter.html#764bde6272f8920f8683400ecedfa5a6">m_data</a></td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Preallocated array of <a class="el" href="classMGT_1_1KmerStateData.html">KmerStateData</a> objects.  <a href="#764bde6272f8920f8683400ecedfa5a6"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="classMGT_1_1KmerStateData.html">KmerStateData</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMGT_1_1KmerCounter.html#97b1f923920993cc686663d4c043b0d4">m_dataDegen</a></td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">One dummy <a class="el" href="classMGT_1_1KmerStateData.html">KmerStateData</a> object that is linked to the zero state, which in turn is set as a reverse-complement one for all other degenerate states.  <a href="#97b1f923920993cc686663d4c043b0d4"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="8461b2b259ad267f52d06985468452b2"></a><!-- doxytag: member="MGT::KmerCounter::m_iDataEnd" ref="8461b2b259ad267f52d06985468452b2" args="" -->
int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMGT_1_1KmerCounter.html#8461b2b259ad267f52d06985468452b2">m_iDataEnd</a></td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Index of the first unused element in m_data. <br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="3cf08d1437c5f57ba7b5679f3ce61886"></a><!-- doxytag: member="MGT::KmerCounter::m_iDataExtr" ref="3cf08d1437c5f57ba7b5679f3ce61886" args="" -->
int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMGT_1_1KmerCounter.html#3cf08d1437c5f57ba7b5679f3ce61886">m_iDataExtr</a></td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Index of m_data element that is currently being extracted. <br></td></tr>
</table>
<hr><a name="_details"></a><h2>Detailed Description</h2>
Class that computes k-mer counts of incoming nucleotide sequence. 
<p>
It processes the input sequence and extracts the counts. Internally, it maintains the <a class="el" href="classMGT_1_1KmerStateData.html">KmerStateData</a> payload data and moves through states of the <a class="el" href="classMGT_1_1KmerStates.html">KmerStates</a> state machine in response to incoming nucleotides. 
<p>
<hr><h2>Constructor &amp; Destructor Documentation</h2>
<a class="anchor" name="e742819d55211c4b487b725ff759953a"></a><!-- doxytag: member="MGT::KmerCounter::KmerCounter" ref="e742819d55211c4b487b725ff759953a" args="(int kmerLen, const AbcConvCharToInt *pAbcConv=0, RC_POLICY revCompPolicy=RC_MERGE, KmerId firstIdState=1)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">MGT::KmerCounter::KmerCounter           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">int&nbsp;</td>
          <td class="mdname" nowrap> <em>kmerLen</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>const <a class="el" href="classMGT_1_1AbcConvCharToInt.html">AbcConvCharToInt</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>pAbcConv</em> = <code>0</code>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>RC_POLICY&nbsp;</td>
          <td class="mdname" nowrap> <em>revCompPolicy</em> = <code>RC_MERGE</code>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>KmerId&nbsp;</td>
          <td class="mdname" nowrap> <em>firstIdState</em> = <code>1</code></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
A constructor. 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>kmerLen</em>&nbsp;</td><td>is a length of a k-mer. In the current implementation, all kmers are precalculated and stored in memory, so be reasonable with this parameter. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>pAbcConv</em>&nbsp;</td><td>is a to <a class="el" href="classMGT_1_1AbcConvCharToInt.html">AbcConvCharToInt</a> alphabet convertor (stored inside this <a class="el" href="classMGT_1_1KmerCounter.html">KmerCounter</a> object but not managed). </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>revCompPolicy</em>&nbsp;</td><td>what to do about reverse complement k-mers </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>firstIdState</em>&nbsp;</td><td>Start k-mer IDs from this value (default 1 as in SVMLight) </td></tr>
  </table>
</dl>
    </td>
  </tr>
</table>
<hr><h2>Member Function Documentation</h2>
<a class="anchor" name="8c3029ba03a356a2d0743c2988e130c2"></a><!-- doxytag: member="MGT::KmerCounter::doCNuc" ref="8c3029ba03a356a2d0743c2988e130c2" args="(CNuc cnuc)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void MGT::KmerCounter::doCNuc           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">CNuc&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>cnuc</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap><code> [inline]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
This method is called to process the input sequence. 
<p>
Series of calls to this method are interleaved with calls to result extraction methods. <dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>cnuc</em>&nbsp;</td><td>one nucleotide character value (such as 'A') </td></tr>
  </table>
</dl>
    </td>
  </tr>
</table>
<a class="anchor" name="51e80461c683377d4a8e05871f99b5c5"></a><!-- doxytag: member="MGT::KmerCounter::getState" ref="51e80461c683377d4a8e05871f99b5c5" args="() const " --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">const <a class="el" href="classMGT_1_1KmerState.html">PKmerState</a> MGT::KmerCounter::getState           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap> const<code> [inline]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Accessor to get pointer to the state for the currently extracted k-mer. 
<p>
Should be used only by implementation-aware code such as <a class="el" href="classMGT_1_1KmerCounterLadder.html">KmerCounterLadder</a>     </td>
  </tr>
</table>
<a class="anchor" name="346502c83e1eaaf1f2f56e9a75497374"></a><!-- doxytag: member="MGT::KmerCounter::getStates" ref="346502c83e1eaaf1f2f56e9a75497374" args="()" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"><a class="el" href="classMGT_1_1KmerStates.html">KmerStates</a>&amp; MGT::KmerCounter::getStates           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap><code> [inline]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Get reference to internal <a class="el" href="classMGT_1_1KmerStates.html">KmerStates</a> array. 
<p>
Declared public only to be used by implementation-aware code such as <a class="el" href="classMGT_1_1KmerCounterLadder.html">KmerCounterLadder</a>.     </td>
  </tr>
</table>
<a class="anchor" name="16c87e77c11ec12a1737ec488e3dcffc"></a><!-- doxytag: member="MGT::KmerCounter::indState" ref="16c87e77c11ec12a1737ec488e3dcffc" args="() const " --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">Ind MGT::KmerCounter::indState           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap> const<code> [inline]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Accessor to get index of the state for the currently extracted k-mer. 
<p>
Should be used only by implementation-aware code such as <a class="el" href="classMGT_1_1KmerCounterLadder.html">KmerCounterLadder</a>     </td>
  </tr>
</table>
<a class="anchor" name="e8f68bd7f63538018130c330a7c0c47a"></a><!-- doxytag: member="MGT::KmerCounter::maxNumKmers" ref="e8f68bd7f63538018130c330a7c0c47a" args="(ULong seqLen) const " --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int MGT::KmerCounter::maxNumKmers           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">ULong&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>seqLen</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap> const<code> [inline]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Return the maximum number of unique k-mers that can be found in a sequence of a given length. 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>seqLen</em>&nbsp;</td><td>sequence length </td></tr>
  </table>
</dl>
    </td>
  </tr>
</table>
<a class="anchor" name="505f456b240c83241a312a43f7baf935"></a><!-- doxytag: member="MGT::KmerCounter::startKmer" ref="505f456b240c83241a312a43f7baf935" args="(bool doSort=true)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void MGT::KmerCounter::startKmer           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">bool&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>doSort</em> = <code>true</code>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap><code> [inline]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Prepare internal state for result extraction. 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>doSort</em>&nbsp;</td><td>- if true, the results will be sorted (complexity will be N*log(N) where N is <a class="el" href="classMGT_1_1KmerCounter.html#23c040924a5342ae5983c559a63abdb4">numKmers()</a>. SVM sparse feature vector representation needs sorted results. </td></tr>
  </table>
</dl>
    </td>
  </tr>
</table>
<a class="anchor" name="16cd8709c9c06ecd161908077474caad"></a><!-- doxytag: member="MGT::KmerCounter::sumDegenKmerCounts" ref="16cd8709c9c06ecd161908077474caad" args="() const " --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">ULong MGT::KmerCounter::sumDegenKmerCounts           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap> const<code> [inline]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Return sum of degenerate k-mer counts found so far in current accumulation cycle. 
<p>
Can be only called outside of <a class="el" href="classMGT_1_1KmerCounter.html#505f456b240c83241a312a43f7baf935">startKmer()</a>...<a class="el" href="classMGT_1_1KmerCounter.html#3074692ee8bdbc3df80a235e4e9f8228">finishKmer()</a> block. Complexity: constant time     </td>
  </tr>
</table>
<a class="anchor" name="8a2305e881fab8f4ae1f027db12cc728"></a><!-- doxytag: member="MGT::KmerCounter::sumKmerCounts" ref="8a2305e881fab8f4ae1f027db12cc728" args="() const " --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">ULong MGT::KmerCounter::sumKmerCounts           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap> const<code> [inline]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Return sum of non-degenerate k-mer counts found so far in current accumulation cycle. 
<p>
Can be only called outside of <a class="el" href="classMGT_1_1KmerCounter.html#505f456b240c83241a312a43f7baf935">startKmer()</a>...<a class="el" href="classMGT_1_1KmerCounter.html#3074692ee8bdbc3df80a235e4e9f8228">finishKmer()</a> block. Complexity: linear in the number of found km-mers.     </td>
  </tr>
</table>
<hr><h2>Member Data Documentation</h2>
<a class="anchor" name="764bde6272f8920f8683400ecedfa5a6"></a><!-- doxytag: member="MGT::KmerCounter::m_data" ref="764bde6272f8920f8683400ecedfa5a6" args="" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">std::vector&lt;<a class="el" href="classMGT_1_1KmerStateData.html">KmerStateData</a>&gt; <a class="el" href="classMGT_1_1KmerCounter.html#764bde6272f8920f8683400ecedfa5a6">MGT::KmerCounter::m_data</a><code> [protected]</code>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Preallocated array of <a class="el" href="classMGT_1_1KmerStateData.html">KmerStateData</a> objects. 
<p>
Array size is equal to the total number of states. This guarantees that there is always enough data elements regardless of the input sequence length. <dl compact><dt><b><a class="el" href="todo.html#_todo000001">Todo:</a></b></dt><dd>Current array size is more than 50% excessive because we only store counts for one of every two reverse-complement states, and all degenerate states have zero state set as their reverse complement. This is a low priority optimization. </dd></dl>
    </td>
  </tr>
</table>
<a class="anchor" name="97b1f923920993cc686663d4c043b0d4"></a><!-- doxytag: member="MGT::KmerCounter::m_dataDegen" ref="97b1f923920993cc686663d4c043b0d4" args="" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"><a class="el" href="classMGT_1_1KmerStateData.html">KmerStateData</a> <a class="el" href="classMGT_1_1KmerCounter.html#97b1f923920993cc686663d4c043b0d4">MGT::KmerCounter::m_dataDegen</a><code> [protected]</code>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
One dummy <a class="el" href="classMGT_1_1KmerStateData.html">KmerStateData</a> object that is linked to the zero state, which in turn is set as a reverse-complement one for all other degenerate states. 
<p>
This way, it serves as a sink counter for all degenerate states. That in turn removes one branch condition from the time-critical code in <a class="el" href="classMGT_1_1KmerCounter.html#bee2df622432c361b9dde075212cff3d">doINuc()</a>. We also query from it the total count of degenerate states in the last accumulation cycle.     </td>
  </tr>
</table>
<hr>The documentation for this class was generated from the following files:<ul>
<li>mgtaxa/include/mgtaxa/kmers.hpp<li>mgtaxa/include/mgtaxa/kmers_inc.hpp<li>mgtaxa/src/kmers.cpp</ul>
<hr size="1"><address style="align: right;"><small>Generated on Wed Jul 29 17:53:22 2009 for Mgtaxa by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.4.6 </small></address>
</body>
</html>
